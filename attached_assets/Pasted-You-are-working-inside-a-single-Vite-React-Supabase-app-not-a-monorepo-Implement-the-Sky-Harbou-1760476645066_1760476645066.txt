You are working inside a single Vite/React + Supabase app (not a monorepo). Implement the Sky Harbour + Freedom Aviation Hangar features and pricing logic in-place.

================================
1) Database: idempotent SQL
================================
Run these migrations against Supabase:

-- Locations for pricing + default hangar cost
create table if not exists public.pricing_locations (
  id uuid primary key default gen_random_uuid(),
  name text not null unique,
  slug text not null unique,
  default_hangar_cost numeric,
  is_active boolean default true,
  updated_at timestamptz default now()
);

-- Per-aircraft pricing overrides (attach to existing aircraft)
create table if not exists public.aircraft_pricing_overrides (
  aircraft_id uuid primary key references public.aircraft(id) on delete cascade,
  location_id uuid references public.pricing_locations(id),
  class_name text not null,                -- e.g., "Class II W Hangar"
  custom_price numeric,                    -- overrides class default
  hangar_cost numeric,                     -- overrides location default
  start_month int check (start_month between 1 and 12),
  updated_at timestamptz default now()
);

-- Global assumptions (singleton)
create table if not exists public.settings_pricing_assumptions (
  id int primary key default 1,
  labor_rate numeric not null default 30,
  card_fee_pct numeric not null default 3,
  cfi_allocation numeric not null default 42,
  cleaning_supplies numeric not null default 50,
  overhead_per_ac numeric not null default 106,
  avionics_db_per_ac numeric not null default 0,
  status text not null default 'draft',
  version int not null default 1,
  updated_at timestamptz not null default now()
);

-- Class cost templates
create table if not exists public.pricing_classes (
  id uuid primary key default gen_random_uuid(),
  name text not null unique,
  default_price numeric not null,
  labor_hours numeric not null,
  avionics_db numeric not null default 0,
  consumables numeric not null default 0,
  is_active boolean default true,
  updated_at timestamptz default now()
);

-- Snapshots (published pricebook)
create table if not exists public.pricing_snapshots (
  id uuid primary key default gen_random_uuid(),
  label text not null,
  created_by uuid default auth.uid(),
  created_at timestamptz not null default now(),
  payload jsonb not null
);

-- RLS: only ADMIN can edit config; any signed-in can read snapshots
alter table public.pricing_locations enable row level security;
alter table public.aircraft_pricing_overrides enable row level security;
alter table public.settings_pricing_assumptions enable row level security;
alter table public.pricing_classes enable row level security;
alter table public.pricing_snapshots enable row level security;

create policy "pricing admin all" on public.pricing_locations
  for all using (exists(select 1 from public.user_roles ur where ur.user_id=auth.uid() and ur.role='ADMIN'));
create policy "pricing admin all aovr" on public.aircraft_pricing_overrides
  for all using (exists(select 1 from public.user_roles ur where ur.user_id=auth.uid() and ur.role='ADMIN'));
create policy "pricing admin all assump" on public.settings_pricing_assumptions
  for all using (exists(select 1 from public.user_roles ur where ur.user_id=auth.uid() and ur.role='ADMIN'));
create policy "pricing admin all class" on public.pricing_classes
  for all using (exists(select 1 from public.user_roles ur where ur.user_id=auth.uid() and ur.role='ADMIN'));

create policy "snapshots read signed" on public.pricing_snapshots
  for select using (auth.uid() is not null);
create policy "snapshots write admin" on public.pricing_snapshots
  for insert using (exists(select 1 from public.user_roles ur where ur.user_id=auth.uid() and ur.role='ADMIN'));

-- Seed / update locations (Sky Harbour + FA Hangar)
insert into public.pricing_locations (name, slug, default_hangar_cost, is_active)
values ('Sky Harbour','sky-harbour',2000,true)
on conflict (slug) do update set default_hangar_cost=excluded.default_hangar_cost, is_active=true;

insert into public.pricing_locations (name, slug, default_hangar_cost, is_active)
values ('Freedom Aviation Hangar','freedom-aviation-hangar',1500,true)
on conflict (slug) do update set default_hangar_cost=excluded.default_hangar_cost, is_active=true;

insert into public.pricing_locations (name, slug, is_active)
values ('None','none',true)
on conflict (slug) do nothing;

-- Seed classes from our spreadsheet
insert into public.pricing_classes (name, default_price, labor_hours, avionics_db, consumables) values
('Class I (C182)',  500,  5, 0,  15),
('Class II W/O hangar', 1000, 7, 0, 200),
('Class II W Hangar',   3500,10, 0, 200),
('Class III (Vision Jet)', 5000,22, 0, 300)
on conflict (name) do nothing;

-- Seed assumptions (singleton)
insert into public.settings_pricing_assumptions (id, labor_rate, card_fee_pct, cfi_allocation, cleaning_supplies, overhead_per_ac, avionics_db_per_ac, status, version)
values (1, 30, 3, 42, 50, 106, 0, 'draft', 1)
on conflict (id) do update set labor_rate=excluded.labor_rate, card_fee_pct=excluded.card_fee_pct, cfi_allocation=excluded.cfi_allocation, cleaning_supplies=excluded.cleaning_supplies, overhead_per_ac=excluded.overhead_per_ac, avionics_db_per_ac=excluded.avionics_db_per_ac, updated_at=now();

create index if not exists ix_pricing_overrides_loc on public.aircraft_pricing_overrides (location_id);
create index if not exists ix_pricing_locations_slug on public.pricing_locations (slug);

================================
2) Local pricing engine (TS only)
================================
Create files under src/lib/pricing/:

src/lib/pricing/types.ts
--------------------------------
export type Assumptions = {
  labor_rate: number; card_fee_pct: number; cfi_allocation: number;
  cleaning_supplies: number; overhead_per_ac: number; avionics_db_per_ac: number;
};
export type ClassCfg = {
  id: string; name: string; default_price: number; labor_hours: number;
  avionics_db: number; consumables: number;
};
export type LocationRef = { id: string; name: string; slug: string; default_hangar_cost: number | null };
export type RowInput = {
  tail: string; class_name: string; custom_price?: number | null;
  hangar_cost?: number | null; location?: LocationRef | null;
};
export type RowOutput = RowInput & {
  final_price: number; labor_cost: number; cfi: number; cleaning: number;
  avionics_db: number; consumables: number; overhead: number; cc_fee: number;
  hangar_derived: number; total_cost: number; net_revenue: number; margin_pct: number;
};

src/lib/pricing/calc.ts
--------------------------------
import { Assumptions, ClassCfg, RowInput, RowOutput } from './types';

export function calcRow(a: Assumptions, cls: ClassCfg, row: RowInput): RowOutput {
  const final_price = Number(row.custom_price ?? cls.default_price) || 0;
  const labor_cost = cls.labor_hours * a.labor_rate;
  const cfi = a.cfi_allocation;
  const cleaning = a.cleaning_supplies;
  const avionics_db = cls.avionics_db || a.avionics_db_per_ac || 0;
  const consumables = cls.consumables || 0;
  const overhead = a.overhead_per_ac;
  const hangar_derived = row.hangar_cost ?? row.location?.default_hangar_cost ?? 0;
  const cc_fee = Math.round(final_price * (a.card_fee_pct/100));
  const total_cost = hangar_derived + labor_cost + cfi + cleaning + avionics_db + consumables + overhead + cc_fee;
  const net_revenue = final_price - total_cost;
  const margin_pct = final_price > 0 ? net_revenue / final_price : 0;
  return { ...row, final_price, labor_cost, cfi, cleaning, avionics_db, consumables, overhead, cc_fee, hangar_derived, total_cost, net_revenue, margin_pct };
}

export function formatMoney(n: number) {
  return new Intl.NumberFormat(undefined, { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(n || 0);
}

src/lib/pricing/index.ts
--------------------------------
export * from './types';
export * from './calc';

================================
3) Console Admin UI (in-app)
================================
Add an Admin page under src/pages/admin/PricingConfigurator.tsx that includes:
- Assumptions form (labor rate, fees, etc.) with save
- Locations table (name, slug, default_hangar_cost)
- Classes table (name, default_price, labor_hours, consumables, avionics_db)
- Fleet grid (list aircraft joined with overrides + location). Columns:
  Tail | Class | Location | Custom Price | Hangar Override | Derived Hangar | Final Price | Total Cost | Margin %
  Derived Hangar = override ?? location.default_hangar_cost ?? 0
  Color code margin: red <20%, amber 20–30%, green >30%

Data hooks (place in src/features/pricing/hooks.ts):
- useAssumptions(), useLocations(), useClasses(), useOverrides(), useAircraft()
  - Use TanStack Query and Supabase; validate with Zod (basic shape).
- save handlers for each table.

Add a “Publish” button that:
- Reads assumptions/classes/locations/overrides + aircraft
- Computes rows with calcRow()
- Inserts a new JSON payload into public.pricing_snapshots(label: current date/version)

================================
4) Marketing pages (in-app)
================================
Create routes/pages:

src/pages/partners/SkyHarbour.tsx
--------------------------------
- Hero: “Freedom Aviation × Sky Harbour”
- Copy: “Purpose-built private hangars at KAPA integrated into your plan. Hangar economics are included in pricing.”
- CTA: link to /pricing?location=sky-harbour
- Add minimal FAQ and JSON-LD via a <script type="application/ld+json"> with Organization/FAQ schema.

src/pages/partners/FAHangar.tsx
--------------------------------
- Hero: “Freedom Aviation Hangar (KAPA)”
- Copy: “Our home-base hangar option—fast turns, predictable access. We model the hangar line directly in your monthly price.”
- CTA: link to /pricing?location=freedom-aviation-hangar
- JSON-LD similar to Sky Harbour page.

src/pages/Pricing.tsx
--------------------------------
- Read the latest pricing_snapshots (one row) via Supabase.
- Location selector at top: None, Sky Harbour, Freedom Aviation Hangar (default from ?location= slug).
- For each class, show:
  Base (class default) + Hangar (selected location default) = Estimated Total
- Fine print: “Representative pricing; aircraft may have overrides.”

Add a small partner badge module to your homepage (src/pages/index.tsx):
- “Preferred Hangar Partners: Sky Harbour • Freedom Aviation Hangar”
- Link badges to partner pages.

================================
5) Feature flags (simple)
================================
Create src/lib/flags.ts:
export const FEATURE_PARTNER_SKY_HARBOUR = true;
export const FEATURE_PARTNER_FA_HANGAR = true;

Gate badges/pages if flags are toggled false.

================================
6) Minimal tests (optional quick win)
================================
Create src/lib/pricing/calc.test.ts (Vitest):
- Assert hangar_derived picks override > location > 0
- Assert total_cost/margin change with location defaults

================================
7) Wire routes & nav
================================
- Add “Pricing” to marketing nav.
- Add “Partners → Sky Harbour” and “Partners → Freedom Aviation Hangar” links.
- Add “Admin → Pricing Configurator” guarded to ADMIN role via user_roles.

Ensure the app builds and pages load with the new routes and components.